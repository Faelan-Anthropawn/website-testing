<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline Audio Visualizer Export</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Fondamento:ital@0;1&family=Georgia&family=Courier+Prime&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": { 
                            DEFAULT: "#6366f1",
                            600: "#4f46e5",
                            700: "#4338ca"
                        }
                    },
                    fontFamily: {
                        "sans": ["Inter", "system-ui", "sans-serif"]
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --transition-fast: 150ms;
            --transition-normal: 250ms;
        }

        body {
            @apply bg-slate-900;
        }

        .card {
            @apply bg-slate-800/50 border border-slate-700/50 rounded-xl backdrop-blur-sm transition-all;
        }

        .card:hover {
            @apply border-primary/50 shadow-lg shadow-primary/10;
        }

        .btn-primary {
            @apply bg-gradient-to-br from-primary to-primary-600 text-white font-medium transition-all hover:shadow-lg hover:shadow-primary/40 hover:-translate-y-0.5 active:translate-y-0;
        }

        .btn-secondary {
            @apply bg-slate-700/50 border border-slate-600/50 text-slate-200 font-medium transition-all hover:bg-slate-600/50 hover:border-primary/50;
        }

        .input-field {
            @apply bg-slate-800/50 border border-slate-700/50 text-white placeholder-slate-500 rounded-lg transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none;
        }

        input[type="color"].input-field {
            @apply h-10 cursor-pointer;
        }

        .section-title {
            @apply text-xs font-bold text-slate-400 uppercase tracking-wider;
        }

        .canvas-container {
            @apply card p-4 h-full flex items-center justify-center overflow-hidden;
        }

        canvas {
            @apply rounded-lg;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
    </style>
</head>
<body class="dark bg-slate-900 text-slate-100">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-gradient-to-br from-slate-800 to-slate-900 border-b border-slate-700/50">
            <div class="px-8 py-6">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-primary via-blue-400 to-primary bg-clip-text text-transparent">
                    Offline Audio Visualizer ‚Üí Video
                </h1>
                <p class="text-slate-400 text-sm mt-1">Create stunning video visualizations with frequency analysis</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 overflow-hidden">
            <div class="h-full flex gap-6 p-6">
                <!-- LEFT SIDEBAR: Setup & Add Element -->
                <div class="w-80 flex flex-col gap-4 overflow-y-auto">
                    <!-- Audio & Image & Metadata Section -->
                    <div class="card p-6">
                        <h2 class="section-title mb-4">Setup</h2>
                        <div class="space-y-3">
                            <label class="block">
                                <span class="text-sm text-slate-300 mb-2 block">Audio File</span>
                                <input type="file" id="audioFile" accept="audio/*" class="input-field w-full file:mr-4 file:px-4 file:py-2 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary-600" />
                            </label>
                            <label class="block">
                                <span class="text-sm text-slate-300 mb-2 block">Background Image</span>
                                <input type="file" id="imageFile" accept="image/*" class="input-field w-full file:mr-4 file:px-4 file:py-2 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary-600" />
                            </label>
                            <label class="block">
                                <span class="text-sm text-slate-300 mb-2 block">Song Name</span>
                                <input type="text" id="songName" placeholder="Song Name" class="input-field w-full px-3 py-2" />
                            </label>
                            <label class="block">
                                <span class="text-sm text-slate-300 mb-2 block">Artist Name</span>
                                <input type="text" id="artistName" placeholder="Artist Name" class="input-field w-full px-3 py-2" />
                            </label>
                            <label class="block">
                                <span class="text-sm text-slate-300 mb-2 block">Default Font</span>
                                <select id="fontFamily" class="input-field w-full px-3 py-2">
                                    <option value="Fondamento">Fondamento</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Arial">Arial</option>
                                    <option value="Courier Prime">Courier Prime</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <!-- Add Element Button -->
                    <div class="card p-6">
                        <button id="addElementBtn" class="btn-primary w-full py-3 rounded-lg font-semibold">
                            + Add Element
                        </button>
                    </div>
                </div>

                <!-- CENTER: CANVAS + PREVIEW CONTROLS -->
                <div class="flex-1 min-w-0 min-h-0 flex flex-col gap-4">
                    <!-- Canvas -->
                    <div class="flex-1 min-h-0">
                        <div class="canvas-container h-full w-full">
                            <canvas id="canvas" width="1280" height="720" style="aspect-ratio: 16/9;"></canvas>
                        </div>
                    </div>

                    <!-- Preview Controls Below Canvas -->
                    <div class="card p-6">
                        <h2 class="section-title mb-4">Preview</h2>
                        <div class="space-y-4">
                            <div class="flex gap-2">
                                <button id="playBtn" class="btn-primary flex-1 py-2 rounded-lg font-semibold">
                                    ‚ñ∂ Play
                                </button>
                                <button id="stopBtn" class="btn-secondary flex-1 py-2 rounded-lg font-semibold">
                                    ‚èπ Stop
                                </button>
                            </div>
                            <div class="flex items-center gap-2">
                                <input type="range" id="timeSlider" min="0" max="100" value="0" class="flex-1 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-primary" />
                                <span id="timeDisplay" class="text-xs text-slate-400 min-w-12 text-right">0:00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- RIGHT SIDEBAR: Add Element Menu, Elements List & Editor -->
                <div class="w-80 flex flex-col gap-4 overflow-y-auto">
                    <!-- Add Element Submenu (Hidden by default) -->
                    <div id="addElementMenu" class="hidden card p-4 space-y-2">
                        <button type="button" id="addSongTitle" class="w-full text-left px-4 py-2 rounded-lg hover:bg-slate-700/50 transition-all text-sm bg-transparent text-slate-300">
                            üéµ Song Title & Artist
                        </button>
                        <button type="button" id="addText" class="w-full text-left px-4 py-2 rounded-lg hover:bg-slate-700/50 transition-all text-sm bg-transparent text-slate-300">
                            üìù Custom Text
                        </button>
                        <button type="button" id="addVisualizer" class="w-full text-left px-4 py-2 rounded-lg hover:bg-slate-700/50 transition-all text-sm bg-transparent text-slate-300">
                            üéõÔ∏è Visualizer Bars
                        </button>
                        <button type="button" id="addBackground" class="w-full text-left px-4 py-2 rounded-lg hover:bg-slate-700/50 transition-all text-sm bg-transparent text-slate-300">
                            üñºÔ∏è Background Image
                        </button>
                    </div>

                    <!-- Elements List -->
                    <div class="card p-6 flex-1 flex flex-col">
                        <h2 class="section-title mb-4">Elements</h2>
                        <div id="elementsList" class="space-y-2 flex-1 overflow-y-auto">
                            <div class="text-slate-500 text-xs text-center py-8">No elements yet</div>
                        </div>
                    </div>

                    <!-- Element Editor -->
                    <div id="selectedElementControls" class="hidden card p-6">
                        <h2 class="section-title mb-4">Edit Element</h2>
                        <div class="space-y-4">
                            <!-- Text Editor (for text, song-title, song-artist) -->
                            <div id="textEditorSection" class="hidden">
                                <div>
                                    <label class="text-sm text-slate-300 block mb-2">Text</label>
                                    <input type="text" id="elementText" placeholder="Enter text" class="input-field w-full px-3 py-2" />
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="text-sm text-slate-300 block mb-2">Size</label>
                                        <input type="number" id="elementSize" min="8" max="200" value="48" class="input-field w-full px-3 py-2" />
                                    </div>
                                    <div>
                                        <label class="text-sm text-slate-300 block mb-2">Color</label>
                                        <input type="color" id="elementColor" value="#ffffff" class="input-field w-full" />
                                    </div>
                                </div>
                                <div>
                                    <label class="text-sm text-slate-300 block mb-2">Font</label>
                                    <select id="elementFont" class="input-field w-full px-3 py-2">
                                        <option value="Fondamento">Fondamento</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Arial">Arial</option>
                                        <option value="Courier Prime">Courier Prime</option>
                                    </select>
                                </div>
                                <div class="space-y-2">
                                    <label class="flex items-center gap-2 text-sm text-slate-300">
                                        <input type="checkbox" id="elementBold" class="w-4 h-4" />
                                        Bold
                                    </label>
                                    <label class="flex items-center gap-2 text-sm text-slate-300">
                                        <input type="checkbox" id="elementItalic" class="w-4 h-4" />
                                        Italic
                                    </label>
                                    <label class="flex items-center gap-2 text-sm text-slate-300">
                                        <input type="checkbox" id="elementDropShadow" class="w-4 h-4" />
                                        Drop Shadow
                                    </label>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="text-sm text-slate-300 block mb-2">X Offset</label>
                                        <input type="number" id="elementOffsetX" value="0" class="input-field w-full px-3 py-2" />
                                    </div>
                                    <div>
                                        <label class="text-sm text-slate-300 block mb-2">Y Offset</label>
                                        <input type="number" id="elementOffsetY" value="0" class="input-field w-full px-3 py-2" />
                                    </div>
                                </div>
                            </div>

                            <!-- Visualizer Editor -->
                            <div id="visualizerEditorSection" class="hidden">
                                <p class="text-sm text-slate-300">Frequency bars display at the bottom of the video</p>
                            </div>

                            <!-- Background Editor -->
                            <div id="backgroundEditorSection" class="hidden">
                                <p class="text-sm text-slate-300">Uses the background image from setup</p>
                            </div>

                            <button id="deleteElement" class="w-full bg-gradient-to-br from-red-600 to-red-700 text-white font-medium py-2 rounded-lg hover:shadow-lg hover:shadow-red/40 transition-all">
                                Delete Element
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <!-- Export Button (Fixed) -->
        <button id="exportBtn" class="fixed bottom-6 right-6 btn-primary px-6 py-3 rounded-lg font-semibold flex items-center gap-2 shadow-lg z-40">
            <span class="material-symbols-outlined">download</span>
            Export
        </button>

        <!-- Export Modal -->
        <div id="exportModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm">
            <div class="card p-8 w-full max-w-sm mx-4">
                <h2 class="text-2xl font-bold text-white mb-2">Export Video</h2>
                <p class="text-sm text-slate-400 mb-6">Exporting at 1440p @ 50 FPS</p>
                
                <div class="flex gap-3 pt-4">
                    <button id="exportCancel" class="btn-secondary flex-1 py-3 rounded-lg font-semibold">
                        Cancel
                    </button>
                    <button id="beginRender" class="btn-primary flex-1 py-3 rounded-lg font-semibold">
                        Begin Render
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="app.js?v=20251228192700"></script>
</body>
</html>
